# =============================================================================
# HARDENED GPG CONFIGURATION
# =============================================================================
# Sources: drduh/config, Privacy Guides, GnuPG documentation
# Last updated: 2025

# -----------------------------------------------------------------------------
# Character Encoding
# -----------------------------------------------------------------------------
charset utf-8

# -----------------------------------------------------------------------------
# Agent & Interface
# -----------------------------------------------------------------------------
use-agent
no-greeting
fixed-list-mode

# -----------------------------------------------------------------------------
# Output Privacy
# -----------------------------------------------------------------------------
no-comments
no-emit-version
armor

# -----------------------------------------------------------------------------
# Key Display
# -----------------------------------------------------------------------------
keyid-format 0xlong
with-fingerprint
with-subkey-fingerprint
with-key-origin
list-options show-uid-validity
verify-options show-uid-validity

# -----------------------------------------------------------------------------
# Algorithm Preferences (for new keys and encryption)
# -----------------------------------------------------------------------------
personal-cipher-preferences AES256 AES192 AES
personal-digest-preferences SHA512 SHA384 SHA256
personal-compress-preferences ZLIB BZIP2 ZIP Uncompressed
default-preference-list SHA512 SHA384 SHA256 AES256 AES192 AES ZLIB BZIP2 ZIP Uncompressed

# -----------------------------------------------------------------------------
# Signing & Certification
# -----------------------------------------------------------------------------
cert-digest-algo SHA512

# -----------------------------------------------------------------------------
# Symmetric Encryption (Passphrase-based)
# -----------------------------------------------------------------------------
s2k-digest-algo SHA512
s2k-cipher-algo AES256
s2k-count 65011712
no-symkey-cache

# -----------------------------------------------------------------------------
# Weak Algorithm Rejection
# -----------------------------------------------------------------------------
weak-digest SHA1
disable-cipher-algo 3DES

# -----------------------------------------------------------------------------
# Key Verification & Security
# -----------------------------------------------------------------------------
require-cross-certification
require-secmem

# -----------------------------------------------------------------------------
# Recipient Privacy
# -----------------------------------------------------------------------------
throw-keyids

# -----------------------------------------------------------------------------
# Default Key
# -----------------------------------------------------------------------------
default-key 0xD67D4AFF6AABD063
trusted-key 0xD67D4AFF6AABD063
default-recipient-self

# -----------------------------------------------------------------------------
# Keyserver
# -----------------------------------------------------------------------------
keyserver hkps://keys.openpgp.org

# -----------------------------------------------------------------------------
# Key Discovery
# -----------------------------------------------------------------------------
auto-key-locate wkd,dane,local
# auto-key-retrieve â€” DISABLED: leaks what messages you read

# -----------------------------------------------------------------------------
# Trust Model
# -----------------------------------------------------------------------------
trust-model tofu+pgp
tofu-default-policy unknown

# -----------------------------------------------------------------------------
# Disabled Options (reference)
# -----------------------------------------------------------------------------
#verbose
#list-options show-unusable-subkeys
#group keygroup = 0xFF00000000000003 0xFF00000000000002 0xFF00000000000001
